<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Exchange & Archives</title>
<style>
    /* THEME: Anime Vanguards (AV) Style */
    @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Inter:wght@300;400;600&display=swap');

    :root {
        --bg-gradient: radial-gradient(circle at top, #1a0b2e 0%, #050505 100%);
        --card-bg: rgba(20, 20, 25, 0.7);
        --card-border: 1px solid rgba(139, 92, 246, 0.3);
        --text-main: #ffffff;
        --text-muted: #94a3b8;
        
        /* AV Purple/Blue Accents */
        --accent-primary: #8b5cf6; /* Violet */
        --accent-secondary: #06b6d4; /* Cyan */
        --accent-glow: 0 0 15px rgba(139, 92, 246, 0.4);
        
        --input-bg: rgba(0, 0, 0, 0.6);
        --radius: 8px;
    }

    body {
        font-family: 'Inter', sans-serif;
        background: var(--bg-gradient);
        background-attachment: fixed;
        color: var(--text-main);
        margin: 0;
        padding: 40px 20px;
        line-height: 1.6;
        min-height: 100vh;
    }

    .container {
        max-width: 950px;
        margin: 0 auto;
        background: var(--card-bg);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        padding: 40px;
        border: var(--card-border);
        border-radius: var(--radius);
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
    }

    /* Typography */
    h1 {
        text-align: center;
        font-family: 'Rajdhani', sans-serif;
        font-weight: 700;
        text-transform: uppercase;
        font-size: 3rem;
        margin: 0 0 10px 0;
        background: linear-gradient(to right, #fff, #a78bfa);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        letter-spacing: 2px;
        text-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
    }

    .subtitle {
        text-align: center;
        color: var(--text-muted);
        font-family: 'Rajdhani', sans-serif;
        font-size: 1.1rem;
        margin-bottom: 40px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        padding-bottom: 20px;
        letter-spacing: 1px;
    }

    /* NAVIGATION TABS */
    .nav-bar {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 30px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        padding-bottom: 10px;
        flex-wrap: wrap;
    }

    .nav-btn {
        background: transparent;
        border: 1px solid transparent;
        color: var(--text-muted);
        padding: 12px 25px;
        cursor: pointer;
        font-family: 'Rajdhani', sans-serif;
        font-weight: 700;
        text-transform: uppercase;
        font-size: 1.1rem;
        letter-spacing: 1px;
        transition: 0.3s;
        border-radius: var(--radius);
        position: relative;
        overflow: hidden;
    }

    .nav-btn:hover {
        color: #fff;
        background: rgba(255, 255, 255, 0.05);
    }
    
    .nav-btn.active {
        color: #fff;
        background: rgba(139, 92, 246, 0.15);
        border: 1px solid var(--accent-primary);
        box-shadow: var(--accent-glow);
    }

    .tab-content { display: none; animation: fadeIn 0.3s ease-out; }
    .tab-content.active-tab { display: block; }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Sticky Header */
    .total-header {
        position: sticky;
        top: 0;
        background: rgba(15, 15, 20, 0.95);
        backdrop-filter: blur(5px);
        padding: 20px 25px;
        border-radius: var(--radius);
        border: 1px solid rgba(255,255,255,0.08);
        margin-bottom: 30px;
        z-index: 100;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    }

    .total-display {
        font-size: 2rem;
        font-family: 'Rajdhani', sans-serif;
        font-weight: 700;
        color: var(--accent-secondary);
        text-shadow: 0 0 10px rgba(6, 182, 212, 0.4);
    }

    .currency-label {
        font-size: 0.9rem;
        color: var(--text-muted);
        text-transform: uppercase;
        font-weight: 600;
        letter-spacing: 1px;
        display: block;
        text-align: right;
    }
    
    .exp-stats {
        display: flex;
        gap: 20px;
        text-align: right;
    }
    
    .stat-box {
        display: flex;
        flex-direction: column;
    }

    /* Goal Section */
    .goal-section {
        background: rgba(0,0,0,0.3);
        padding: 25px;
        border-radius: var(--radius);
        border: 1px solid rgba(255,255,255,0.05);
        margin-bottom: 40px;
    }

    .goal-inputs {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 20px;
    }

    .input-group { display: flex; flex-direction: column; flex: 1; min-width: 200px; }
    .input-group label { 
        font-family: 'Rajdhani', sans-serif; 
        font-weight: 700;
        font-size: 0.9rem; 
        text-transform: uppercase; 
        letter-spacing: 1px; 
        color: var(--accent-primary); 
        margin-bottom: 8px; 
    }

    input, select {
        background: var(--input-bg);
        border: 1px solid #333;
        color: #fff;
        padding: 12px 15px;
        font-family: 'Inter', sans-serif;
        font-size: 1rem;
        outline: none;
        border-radius: var(--radius);
        transition: 0.3s;
    }

    input:focus, select:focus { 
        border-color: var(--accent-secondary); 
        box-shadow: 0 0 15px rgba(6, 182, 212, 0.2); 
    }

    /* Progress Bar */
    .progress-container {
        height: 6px;
        background-color: #1a1a1a;
        width: 100%;
        margin-top: 20px;
        border-radius: 10px;
        overflow: hidden;
    }
    .progress-bar {
        height: 100%;
        width: 0%;
        background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
        transition: width 0.5s ease;
        box-shadow: 0 0 15px var(--accent-primary);
    }
    .status-message { 
        text-align: right; 
        font-size: 1rem; 
        margin-top: 10px; 
        font-family: 'Rajdhani', sans-serif; 
        font-weight: 600; 
    }
    .missing { color: #f87171; }
    .surplus { color: #4ade80; }

    /* Item Grid */
    .category { margin-bottom: 25px; }
    .category h3 { 
        font-family: 'Rajdhani', sans-serif;
        font-size: 1.4rem; 
        color: #fff; 
        border-bottom: 1px solid rgba(255,255,255,0.1); 
        padding-bottom: 5px; 
        margin-top: 0;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .category h3::before {
        content: '';
        display: block;
        width: 4px;
        height: 1.2rem;
        background: var(--accent-primary);
    }

    .item-grid { 
        display: grid; 
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); 
        gap: 12px; 
    }
    
    .item-row {
        display: flex; 
        justify-content: space-between; 
        align-items: center;
        background: rgba(255,255,255,0.03); 
        padding: 10px 15px; 
        border: 1px solid rgba(255,255,255,0.05);
        border-radius: 6px;
        transition: all 0.2s ease;
    }
    .item-row:hover { 
        background: rgba(255,255,255,0.08); 
        border-color: rgba(139, 92, 246, 0.3);
        transform: translateY(-2px);
    }

    .item-info { display: flex; flex-direction: column; }
    .item-name { font-size: 0.95rem; color: #e2e8f0; font-weight: 600; }
    .item-meta { font-size: 0.75rem; color: #64748b; margin-top: 2px; font-family: 'Rajdhani', sans-serif; letter-spacing: 0.5px; }
    .item-yield { font-size: 0.8rem; color: var(--accent-secondary); font-weight: bold; margin-top: 4px; opacity: 0; transition: opacity 0.3s; }
    
    input.item-input {
        width: 70px; 
        text-align: center; 
        border: 1px solid transparent; 
        background: rgba(0,0,0,0.3);
        color: #fff; 
        font-weight: 700; 
        font-size: 1.1rem;
        font-family: 'Rajdhani', sans-serif;
        border-radius: 4px;
    }
    input.item-input:focus { 
        border-color: var(--accent-secondary); 
        background: #000;
    }
    input.item-input::placeholder { color: #444; }

    .reset-btn {
        background: linear-gradient(135deg, #1e1e24 0%, #2d2d35 100%);
        color: #fff;
        border: 1px solid rgba(255,255,255,0.1);
        padding: 15px; 
        width: 100%; 
        font-family: 'Rajdhani', sans-serif; 
        font-weight: 700;
        font-size: 1.1rem;
        text-transform: uppercase;
        cursor: pointer; 
        transition: 0.3s; 
        margin-top: 30px; 
        letter-spacing: 2px;
        border-radius: var(--radius);
    }
    .reset-btn:hover { 
        background: linear-gradient(135deg, var(--accent-primary) 0%, #7c3aed 100%);
        border-color: transparent;
        box-shadow: 0 0 20px rgba(139, 92, 246, 0.4);
    }

    /* Chrome/Edge number input spinner hide */
    input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    input[type=number] { -moz-appearance: textfield; }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #0f0f12; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--accent-primary); }

</style>
</head>
<body>

<div class="container">
    <h1>The Exchange</h1>
    <div class="subtitle">CALCULATION PROTOCOL // V.2.0</div>

    <div class="nav-bar">
        <button class="nav-btn active" onclick="openTab('exchange')">Exchange Protocol</button>
        <button class="nav-btn" onclick="openTab('dungeon')">Dungeon Archives</button>
        <button class="nav-btn" onclick="openTab('playerExp')">EXP Data</button>
    </div>

    <!-- TAB 1: EXCHANGE -->
    <div id="exchange" class="tab-content active-tab">
        <div class="goal-section">
            <div class="goal-inputs">
                <div class="input-group">
                    <label>Target Unit (Evolution)</label>
                    <select id="charSelect" onchange="updateGoalFromSelect()">
                        <option value="0">-- Select Subject --</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Required Value (Rubies)</label>
                    <input type="number" id="goalAmount" placeholder="0" oninput="calculateExchange()">
                </div>
            </div>
            <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
            <div class="status-message" id="statusMessage">AWAITING INPUT...</div>
        </div>

        <div class="total-header">
            <div>
                <span class="currency-label">Inventory Value</span>
                <span class="total-display" id="exchangeTotal">0</span>
            </div>
        </div>

        <div id="exchangeItemsContainer"></div>
        <button type="button" class="reset-btn" onclick="resetExchange()">Clear Data (Reset)</button>
    </div>

    <!-- TAB 2: DUNGEON -->
    <div id="dungeon" class="tab-content">
        <div class="total-header">
            <div>
                <span class="currency-label">Total Cost (Rubies)</span>
                <span class="total-display" id="dungeonCostTotal" style="color: #4ade80; text-shadow: 0 0 10px rgba(74, 222, 128, 0.3);">0</span>
            </div>
        </div>

        <div id="dungeonItemsContainer"></div>
        <button type="button" class="reset-btn" onclick="resetDungeon()">Clear Selection</button>
    </div>

    <!-- TAB 3: PLAYER EXP -->
    <div id="playerExp" class="tab-content">
        <div class="total-header">
            <div class="exp-stats">
                 <div class="stat-box">
                    <span class="currency-label">Total Runs</span>
                    <span class="total-display" id="expTotalRuns">0</span>
                </div>
                <div class="stat-box">
                    <span class="currency-label">Time Needed</span>
                    <span class="total-display" id="expTotalTime" style="font-size: 1.5rem; margin-top: 5px;">0h 0m</span>
                </div>
            </div>
        </div>

        <div class="goal-section" style="background: rgba(139, 92, 246, 0.05); border-color: var(--accent-primary);">
            <div class="goal-inputs">
                <div class="input-group">
                    <label>Current Level</label>
                    <input type="number" id="currentLevel" value="108" oninput="calculatePlayerExp()">
                </div>
                <div class="input-group">
                    <label>EXP For Next Level</label>
                    <input type="number" id="currentLevelExp" value="229450" oninput="calculatePlayerExp()">
                </div>
                <div class="input-group">
                    <label>Target Level</label>
                    <input type="number" id="targetLevel" placeholder="e.g. 120" oninput="calculatePlayerExp()">
                </div>
            </div>
            <div class="goal-inputs">
                <div class="input-group">
                    <label>EXP Per Run</label>
                    <input type="number" id="expPerRun" placeholder="e.g. 5000" oninput="calculatePlayerExp()">
                </div>
                <div class="input-group">
                    <label>Time Per Run (Min / Sec)</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="number" id="timePerRunMin" placeholder="Min" oninput="calculatePlayerExp()" style="flex:1; min-width:0;">
                        <input type="number" id="timePerRunSec" placeholder="Sec" oninput="calculatePlayerExp()" style="flex:1; min-width:0;">
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
                <span class="currency-label" style="text-align: left; color: #fff;">Total EXP Required:</span>
                <span id="totalExpRequired" style="font-family: 'Rajdhani'; font-size: 1.2rem; color: var(--accent-secondary);">0</span>
            </div>
        </div>
        
        <button type="button" class="reset-btn" onclick="resetPlayerExp()">Reset Calculator</button>
    </div>
</div>

<script>
    // ------------------------------------------------------------------
    // 1. DATA CONFIGURATION
    // ------------------------------------------------------------------

    // User Editable: Character Evolution Costs
    const characterDatabase = [
        { name: "Gojo Evo", cost: 3500 },
        { name: "Madara Evo", cost: 5000 },
    ];

    // Exchange Shop Data
    const exchangeData = [
        { worth: 750, items: ["Hogyoku", "Demon Extract", "Cup of Reincarnation", "Arrancar Helm", "Dark God Cube"] },
        { worth: 500, items: ["Hana Earrings", "Hand of Berserker", "Eye of Avarice", "Super Necklace", "Quincy Cross", "Divine Stone", "Manatite Crystals", "Straw Hat"] },
        { worth: 60, items: ["Demon Mark", "Dragon Rune", "Cyborg Core"] },
        { worth: 40, items: ["Risky Rice", "Kitsune Mask", "Swordsman Hat", "Potora Earrings", "Brand of Sacrifice", "Prison Cube", "Mirage Sphere", "Black Slime", "Philosopher Stone", "Goddess Hairpin", "Mask Fragment"] },
        { worth: 15, items: ["Stealth Rune", "General Hat", "Hero Cape"] },
        { worth: 10, items: ["Slime Hood", "Beach Hat", "Knight Shield", "Capsules", "Alchemist Armor", "Pirate Hat", "Butterfly Pin", "Cursed Finger", "Active Droplet", "Eye Patch", "Joker's Cards"] },
        { worth: 8, items: ["Dominator Rune", "Hero Guidebook", "Handcuffs"] },
        { worth: 5, items: ["Hunter Cards", "Pocket Watch", "Flying Cabbage", "Shinigami Badge", "Edgy Phrase", "Marine Hat", "Briefcases", "RPG Potions", "Senzu Beans", "Bamboo Muzzle", "Inactive Droplet", "Cursed Speech"] }
    ];

    // Dungeon Shop Data
    const dungeonData = [
        { name: "TP Scroll - Floor 11", price: 200, qty: 1 },
        { name: "Impure Soul", price: 350, qty: 1 },
        { name: "Trait Rerolls", price: 500, qty: 5 },
        { name: "Perk Rerolls", price: 500, qty: 5 },
        { name: "Mundane Grimoire", price: 500, qty: 10 },
        { name: "Senzu Beans", price: 300, qty: 20 },
        { name: "Marine Hat", price: 300, qty: 20 },
        { name: "RPG Potions", price: 300, qty: 20 },
        { name: "Cursed Speech", price: 300, qty: 20 },
        { name: "Hunter Cards", price: 300, qty: 20 },
        { name: "Edgy Phrase", price: 300, qty: 20 },
        { name: "Pocket Watch", price: 300, qty: 20 },
        { name: "Shinigami Badge", price: 300, qty: 20 },
        { name: "Flying Cabbage", price: 300, qty: 20 },
        { name: "Inactive Droplet", price: 300, qty: 20 },
        { name: "Capsules", price: 300, qty: 10 },
        { name: "Pirate Hat", price: 300, qty: 10 },
        { name: "Cursed Finger", price: 300, qty: 10 },
        { name: "Jokers Cards", price: 300, qty: 10 },
        { name: "Alchemist Armor", price: 300, qty: 10 },
        { name: "Eye Patch", price: 300, qty: 10 },
        { name: "Beach Hat", price: 300, qty: 10 },
        { name: "Knight Shield", price: 300, qty: 10 },
        { name: "Slime Hood", price: 300, qty: 10 },
        { name: "Active Droplet", price: 300, qty: 10 },
        { name: "Potara Earrings", price: 600, qty: 5 },
        { name: "Black Slime", price: 600, qty: 5 },
        { name: "Prison Cube", price: 600, qty: 5 },
        { name: "Risky Dice", price: 600, qty: 5 },
        { name: "Swordsman Hat", price: 600, qty: 5 },
        { name: "Philosopher Stone", price: 600, qty: 5 },
        { name: "Goddess Hairpin", price: 600, qty: 5 },
        { name: "Mask Fragment", price: 600, qty: 5 },
        { name: "Mirage Sphere", price: 600, qty: 5 },
        { name: "Brand of Sacrifice", price: 600, qty: 5 },
        { name: "Super Necklace", price: 1500, qty: 1 },
        { name: "Straw Hat", price: 1500, qty: 1 },
        { name: "Eye Of Avarice", price: 1500, qty: 1 },
        { name: "Divine Stone", price: 1500, qty: 1 },
        { name: "Quincy Cross", price: 1500, qty: 1 },
        { name: "Hand of Berserker", price: 1500, qty: 1 }
    ];

    // ------------------------------------------------------------------
    // 2. INITIALIZATION (Build UI)
    // ------------------------------------------------------------------

    // Setup Exchange Select
    const selectBox = document.getElementById('charSelect');
    characterDatabase.forEach(char => {
        const option = document.createElement('option');
        option.value = char.cost;
        option.innerText = char.name;
        selectBox.appendChild(option);
    });

    // Setup Exchange Grid
    const exContainer = document.getElementById('exchangeItemsContainer');
    exchangeData.forEach(group => {
        const categoryDiv = document.createElement('div');
        categoryDiv.className = 'category';
        categoryDiv.innerHTML = `<h3>Tier: ${group.worth} Rubies</h3>`;
        const grid = document.createElement('div');
        grid.className = 'item-grid';

        group.items.forEach(item => {
            const row = document.createElement('div');
            row.className = 'item-row';
            row.innerHTML = `
                <div class="item-info">
                    <span class="item-name">${item}</span>
                </div>
                <input type="number" class="exchange-input item-input" min="0" placeholder="0" 
                       data-worth="${group.worth}" oninput="calculateExchange()">
            `;
            grid.appendChild(row);
        });
        categoryDiv.appendChild(grid);
        exContainer.appendChild(categoryDiv);
    });

    // Setup Dungeon Grid
    const dunContainer = document.getElementById('dungeonItemsContainer');
    const dunGrid = document.createElement('div');
    dunGrid.className = 'item-grid';
    
    dungeonData.forEach((item, index) => {
        const row = document.createElement('div');
        row.className = 'item-row';
        const yieldId = `yield-${index}`;
        
        row.innerHTML = `
            <div class="item-info">
                <span class="item-name">${item.name}</span>
                <span class="item-meta">Cost: ${item.price} | Batch: ${item.qty}</span>
                <span id="${yieldId}" class="item-yield">Total Items: 0</span>
            </div>
            <input type="number" class="dungeon-input item-input" min="0" placeholder="0" 
                   data-price="${item.price}" data-qty="${item.qty}" data-yield-id="${yieldId}"
                   oninput="calculateDungeon()">
        `;
        dunGrid.appendChild(row);
    });
    dunContainer.appendChild(dunGrid);


    // ------------------------------------------------------------------
    // 3. LOGIC FUNCTIONS
    // ------------------------------------------------------------------

    // --- Exchange Tab Logic ---
    function updateGoalFromSelect() {
        const val = document.getElementById('charSelect').value;
        if(val !== "0") {
            document.getElementById('goalAmount').value = val;
            calculateExchange();
        }
    }

    function calculateExchange() {
        let total = 0;
        document.querySelectorAll('.exchange-input').forEach(input => {
            total += (parseInt(input.value) || 0) * parseInt(input.dataset.worth);
        });
        document.getElementById('exchangeTotal').innerText = total.toLocaleString();

        const goal = parseInt(document.getElementById('goalAmount').value) || 0;
        const msg = document.getElementById('statusMessage');
        const bar = document.getElementById('progressBar');

        if (goal > 0) {
            const diff = goal - total;
            const pct = Math.min((total / goal) * 100, 100);
            bar.style.width = pct + "%";
            
            if (diff > 0) {
                msg.innerHTML = `MISSING: <span class="missing">${diff.toLocaleString()}</span>`;
                bar.style.background = "linear-gradient(90deg, #f87171, #ef4444)";
            } else {
                msg.innerHTML = `REQ MET. SURPLUS: <span class="surplus">${Math.abs(diff).toLocaleString()}</span>`;
                bar.style.background = "linear-gradient(90deg, #4ade80, #22c55e)";
            }
        } else {
            msg.innerText = "AWAITING INPUT...";
            bar.style.width = "0%";
            bar.style.background = "linear-gradient(90deg, var(--accent-primary), var(--accent-secondary))";
        }
    }

    function resetExchange() {
        document.querySelectorAll('.exchange-input').forEach(i => i.value = '');
        document.getElementById('charSelect').selectedIndex = 0;
        calculateExchange();
    }

    // --- Dungeon Tab Logic ---
    function calculateDungeon() {
        let totalCost = 0;
        document.querySelectorAll('.dungeon-input').forEach(input => {
            const purchases = parseInt(input.value) || 0;
            const price = parseInt(input.dataset.price);
            const batchQty = parseInt(input.dataset.qty);
            const yieldSpan = document.getElementById(input.dataset.yieldId);

            totalCost += (purchases * price);

            if (purchases > 0) {
                const totalItems = purchases * batchQty;
                yieldSpan.innerText = `Total Items: ${totalItems.toLocaleString()}`;
                yieldSpan.style.opacity = "1";
            } else {
                yieldSpan.style.opacity = "0";
            }
        });
        document.getElementById('dungeonCostTotal').innerText = totalCost.toLocaleString();
    }

    function resetDungeon() {
        document.querySelectorAll('.dungeon-input').forEach(i => i.value = '');
        calculateDungeon();
    }

    // --- Player EXP Tab Logic ---
    function calculatePlayerExp() {
        const startLevel = parseInt(document.getElementById('currentLevel').value) || 0;
        const startLevelExp = parseInt(document.getElementById('currentLevelExp').value) || 0;
        const targetLevel = parseInt(document.getElementById('targetLevel').value) || 0;
        const expPerRun = parseInt(document.getElementById('expPerRun').value) || 1;
        
        // New Time Logic
        const timeMin = parseInt(document.getElementById('timePerRunMin').value) || 0;
        const timeSec = parseInt(document.getElementById('timePerRunSec').value) || 0;
        const timePerRun = timeMin + (timeSec / 60);
        
        const growthRate = 1.076; // 7.6% increase
        let totalExpNeeded = 0;
        let currentRequirement = startLevelExp;

        // Validation
        if (targetLevel <= startLevel) {
            document.getElementById('expTotalRuns').innerText = "0";
            document.getElementById('expTotalTime').innerText = "0h 0m";
            document.getElementById('totalExpRequired').innerText = "0";
            return;
        }

        // Loop: Sum EXP for every level from Start to Target
        for (let lvl = startLevel; lvl < targetLevel; lvl++) {
            totalExpNeeded += currentRequirement;
            // Calculate next level requirement based on growth rate
            currentRequirement = Math.floor(currentRequirement * growthRate);
        }

        const totalRuns = Math.ceil(totalExpNeeded / expPerRun);
        const totalMinutes = totalRuns * timePerRun;

        // Convert minutes to H/M
        const hours = Math.floor(totalMinutes / 60);
        const mins = Math.ceil(totalMinutes % 60);

        // Update UI
        document.getElementById('expTotalRuns').innerText = totalRuns.toLocaleString();
        document.getElementById('expTotalTime').innerText = `${hours}h ${mins}m`;
        document.getElementById('totalExpRequired').innerText = totalExpNeeded.toLocaleString();
    }

    function resetPlayerExp() {
        document.getElementById('targetLevel').value = '';
        document.getElementById('expPerRun').value = '';
        document.getElementById('timePerRunMin').value = '';
        document.getElementById('timePerRunSec').value = '';
        // Reset to defaults
        document.getElementById('currentLevel').value = '108';
        document.getElementById('currentLevelExp').value = '229450';
        calculatePlayerExp();
    }

    // --- Tab Switching ---
    function openTab(tabName) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active-tab'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(tabName).classList.add('active-tab');
        event.currentTarget.classList.add('active');
    }

</script>

</body>
</html>
